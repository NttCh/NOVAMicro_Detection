# Re-export the most-used helpers so you can do: from src.utils import load_obj
from .utils import (
    thai_time, set_seed, load_obj, generate_detection_csv, make_run_dirs,
    cleanup_cuda, _reuse_enabled, _resolve_pretrained_ckpt_for_training,
    _print_training_plan, _ckpt_output_tag, read_cfg_snapshot_from_weights,
    load_weights_into_model
)

# callbacks
from .callbacks import (
    MasterValidationMetricsCallback, OptunaCompositeReportingCallback,
    CleanTQDMProgressBar, TrialFoldProgressCallback, OverallProgressCallback,
    LocalTrainEvalCallback,
)

# data
from .data import PatchClassificationDataset, _build_valid_transform

# training & HPO
from .train import train_stage, train_with_cross_validation, repeated_cross_validation, print_trial_thai_callback
from .optuna_tuner import (
    run_optuna_search, apply_best_params_to_cfg, record_trial_history,
    _choose_reuse_trial, _apply_trial_params_to_cfg
)

# viz & inference & xai
from .viz import (
    export_optuna_plots, _run_cv_plots, save_confusion_matrix
)
from .inference import (
    evaluate_model, predict_folders_to_combined_workbook,
    save_multi_ckpt_comparison, _parse_test_folds, _run_multi_ckpt_tests
)
from .xai import _maybe_run_xai

__all__ = [
    # utils
    "thai_time","set_seed","load_obj","generate_detection_csv","make_run_dirs","cleanup_cuda",
    "_reuse_enabled","_resolve_pretrained_ckpt_for_training","_print_training_plan",
    "_ckpt_output_tag","read_cfg_snapshot_from_weights","load_weights_into_model",
    # callbacks
    "MasterValidationMetricsCallback","OptunaCompositeReportingCallback",
    "CleanTQDMProgressBar","TrialFoldProgressCallback","OverallProgressCallback",
    "LocalTrainEvalCallback",
    # data
    "PatchClassificationDataset","_build_valid_transform",
    # training
    "train_stage","train_with_cross_validation","repeated_cross_validation","print_trial_thai_callback",
    # optuna
    "run_optuna_search","apply_best_params_to_cfg","record_trial_history",
    "_choose_reuse_trial","_apply_trial_params_to_cfg",
    # viz
    "export_optuna_plots","_run_cv_plots","save_confusion_matrix",
    # inference
    "evaluate_model","predict_folders_to_combined_workbook","save_multi_ckpt_comparison",
    "_parse_test_folds","_run_multi_ckpt_tests",
    # xai
    "_maybe_run_xai",
]
